# 文件压缩/解压缩工具用户手册

## 一、简介

本软件是一款基于霍夫曼编码（Huffman Coding）的文件和文件夹压缩/解压缩工具。它支持用户对文件或文件夹进行高效的压缩和解压缩操作，并提供可选的密码设置功能，保障数据的安全性。软件采用图形用户界面（GUI），操作简便，适合各类用户使用。

---

## 二、安装与运行

### 1. 环境要求

- **操作系统**：Windows、macOS、Linux
- **Java版本**：JDK 8 或更高版本
- **内存**：至少512MB

### 2. 下载与安装

1. **下载源码**：获取程序的源代码，确保包含以下主要文件：

   - `Main.java`
   - `Compressor.java`
   - `Decompressor.java`
   - `HuffmanCodec.java`

2. **编译程序**：

   在命令行或终端中，进入源码所在目录，执行以下命令：

   ```bash
   javac Main.java Compressor.java Decompressor.java HuffmanCodec.java
   ```

   这将编译所有的源代码文件，生成对应的字节码文件（`.class`文件）。

### 3. 运行程序

执行以下命令启动程序：

```bash
java Main
```

---

## 三、使用指南

### 1. 启动程序

运行程序后，将弹出主界面，界面包括以下部分：

- **选择操作**：压缩或解压缩
- **输入路径**：选择要压缩/解压缩的文件或文件夹
- **输出路径**：选择压缩文件的保存位置或解压缩后文件的存放位置
- **加密密钥（可选）**：设置压缩/解压缩的密码
- **执行按钮**：开始执行所选操作

### 2. 操作步骤

#### **步骤一：选择操作**

- 在“选择操作”下拉菜单中选择：

  - **Compress**：进行压缩操作
  - **Decompress**：进行解压缩操作

#### **步骤二：设置输入路径**

- 点击“输入路径”一栏旁的“浏览”按钮，选择需要压缩或解压缩的文件或文件夹。
- 也可以直接在文本框中手动输入路径。

#### **步骤三：设置输出路径**

- 点击“输出路径”一栏旁的“浏览”按钮，选择压缩文件的保存位置或解压缩后文件的存放位置。
- 输出路径可以是具体的文件名（对于压缩操作）或文件夹路径（对于解压缩操作）。

#### **步骤四：设置加密密钥（可选）**

- 在“加密密钥”文本框中输入密码。
- **注意**：

  - 在压缩时设置的密钥，在解压缩时必须输入相同的密钥才能成功解压。
  - 如果不需要加密，可留空。

#### **步骤五：执行操作**

- 点击“执行”按钮，程序将开始压缩或解压缩操作。
- 操作完成后，会弹出提示信息，告知操作结果。

### 3. 注意事项

- **文件名及覆盖提示**：

  - 当输出路径已存在同名文件或文件夹时，程序会提示是否覆盖。
  - 请根据需要选择“是”或“否”。

- **压缩密码**：

  - 密码仅用于验证，未对实际数据进行加密。
  - 为保证数据安全，建议妥善保管密码。

---

## 四、程序工作原理

### 1. 霍夫曼编码简介

霍夫曼编码是一种基于字符出现频率构建最优二叉树的无损压缩算法。其核心思想是：

- **高频字符**使用**短码**表示
- **低频字符**使用**长码**表示

通过这种方式，整体数据长度被有效压缩。

### 2. 主要模块介绍

#### **1. Main类**

- **功能**：程序入口，负责创建并显示图形用户界面，响应用户操作。
- **主要流程**：

  - 初始化`Compressor`和`Decompressor`对象。
  - 调用`createAndShowGUI()`方法，设置界面组件和布局。
  - 为各按钮添加事件监听器，处理用户交互。

#### **2. Compressor类**

- **功能**：实现文件/文件夹的压缩功能。
- **核心方法**：

  - `compress(String inputPath, String outputPath, String key)`：

    - 判断输入路径是文件还是文件夹。
    - 对于文件，调用`compressFile()`方法压缩。
    - 对于文件夹，调用`compressFolder()`方法递归压缩。

  - `compressFile(String inputFile, String outputFile, String key)`：

    - 读取文件数据。
    - 使用`HuffmanCodec`进行压缩，获取压缩数据和编码表。
    - 如果设置了密钥，计算密钥的哈希值（使用SHA-256算法），并写入压缩文件。
    - 将编码表和压缩数据写入输出文件。

  - `compressFolder(String inputFolder, String outputFolder, String key)`：

    - 遍历文件夹内的所有文件和子文件夹，递归调用压缩方法。

#### **3. Decompressor类**

- **功能**：实现文件/文件夹的解压缩功能。
- **核心方法**：

  - `decompress(String inputPath, String outputPath, String key)`：

    - 判断输入路径是文件还是文件夹。
    - 对于文件，调用`decompressFile()`方法解压。
    - 对于文件夹，调用`decompressFolder()`方法递归解压。

  - `decompressFile(String inputFile, String outputFile, String key)`：

    - 读取压缩文件，获取保存的密钥哈希值。
    - 验证用户提供的密钥是否匹配。
    - 读取编码表和压缩数据。
    - 使用`HuffmanCodec`进行解码，恢复原始数据。
    - 将解压后的数据写入输出文件。

  - `decompressFolder(String inputFolder, String outputFolder, String key)`：

    - 遍历文件夹内的所有文件和子文件夹，递归调用解压方法。

#### **4. HuffmanCodec类**

- **功能**：实现霍夫曼编码的压缩和解压缩算法。
- **核心方法**：

  - `compress(byte[] data)`：

    - 构建频率表，统计每个字节出现的次数。
    - 根据频率表构建霍夫曼树。
    - 生成霍夫曼编码表。
    - 使用编码表将原始数据编码为二进制字符串。
    - 将二进制字符串转换为字节数组，得到压缩后的数据。

  - `decompress(byte[] compressedData, Map<Byte, String> huffmanCodes)`：

    - 根据编码表重建霍夫曼树。
    - 将压缩数据的字节数组转换为二进制字符串。
    - 遍历二进制字符串，通过霍夫曼树解码，恢复原始数据。

### 3. 关键流程详解

#### **压缩流程**

1. **读取文件数据**：将文件内容读取为字节数组。

2. **统计频率**：遍历字节数组，统计每个字节出现的次数，生成频率表。

3. **构建霍夫曼树**：根据频率表，使用优先队列构建霍夫曼树。

4. **生成编码表**：遍历霍夫曼树，为每个字节生成对应的霍夫曼编码。

5. **编码数据**：将原始数据中的每个字节替换为对应的编码，生成完整的编码字符串。

6. **数据转换**：将编码字符串按8位切分，转换为字节数组，得到压缩后的数据。

7. **保存数据**：将密钥哈希值（如果有）、编码表和压缩数据写入输出文件。

#### **解压缩流程**

1. **读取压缩文件**：读取压缩文件中的密钥哈希值、编码表和压缩数据。

2. **验证密钥**：如果压缩文件设置了密钥，验证用户输入的密钥是否正确。

3. **重建霍夫曼树**：根据编码表重建霍夫曼树。

4. **解码数据**：将压缩数据转换为二进制字符串，使用霍夫曼树解码，恢复原始数据。

5. **保存数据**：将解码后的原始数据写入输出文件。

---

## 五、常见问题解答

### 1. 为什么解压缩时提示“提供的解密密钥无效”？

- **可能原因**：输入的密钥与压缩时设置的密钥不一致。
- **解决方法**：确保输入正确的密钥，注意大小写和空格。

### 2. 压缩后生成的文件无法解压或解压后文件损坏怎么办？

- **可能原因**：压缩过程中出现错误，导致数据不完整。
- **解决方法**：重新进行压缩操作，确保过程不被中断。

### 3. 如何提高压缩效率？

- **建议**：

  - 对于大文件，确保程序有足够的内存使用空间。
  - 可以适当增大缓冲区大小（`BUFFER_SIZE`），但要考虑系统性能。

### 4. 密钥是如何保障安全性的？

- **说明**：

  - 程序在压缩时，对用户提供的密钥进行SHA-256哈希处理，并存储哈希值。
  - 在解压缩时，用户需要提供密钥，程序同样进行哈希处理，并与存储的哈希值比对。
  - 只有密钥一致，才能继续解压缩操作。

---

## 六、联系方式

如有任何疑问或建议，欢迎与我们联系：

- **邮箱**：2635321490@qq.com

---

感谢您使用本文件压缩/解压缩工具！我们致力于提供高效、安全的文件管理体验。如有任何问题，欢迎反馈。
